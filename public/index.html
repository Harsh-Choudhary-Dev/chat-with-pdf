<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<style>
    body {
        background-color: #2a2c2e;
        overflow-y: hidden;
        overflow-x: hidden;
    }


    .chat-box-bot {
        width: 57vh;
        height: 100vh;
    }

    .offcanvas {
        background-color: #434143;
        color: aliceblue;
    }

    .main-container {
        color: aliceblue;

    }

    .pdf-container {
        width: 155vh;
        height: 100vh;
        overflow-y: auto;

    }

    .pdf-analysis {
        position: absolute;
        bottom: 2%;
        right: 2%;
    }

    .upload-new-docs {
        position: absolute;
        bottom: 2%;
        left: 1%;
    }

    .btn {
        background: #aa076b;
        /* fallback for old browsers */
        background: -webkit-linear-gradient(to right, #61045f, #aa076b);
        /* Chrome 10-25, Safari 5.1-6 */
        background: linear-gradient(to right, #61045f, #aa076b);
        /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
        color: aliceblue;
    }

    .query-box {
        position: absolute;
        bottom: 2%;
        
    }

    .query-list-box {
        position: absolute;
        bottom: 15%;
        overflow-x: auto;
        width: 42vh;
        height: 72vh;
    }

    .into-heading {
        text-align: center;
        color: #aa076b;
        position: absolute;
        top: 47%;
        left: 50%;
        transform: translate(-50%, -50%);
        /* Compensate for half the width/height */
        width: 125vh;
        /* Adjust width and height as needed */
        height: 200px;
    }


    h1 {
        font-size: 8vh;
        background: -webkit-linear-gradient(#b8cbb8 0%, #b8cbb8 0%, #b465da 0%, #cf6cc9 33%, #ee609c 66%, #ee609c 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    h1+p {
        font-size: 3vh;
        color: #f33aac;
    }

    input {
        height: 12vh;
        border-radius: 2vh;
        background-color: #2a2c2e;
        color: aliceblue;
        width: 42vh;
        border-color: #61045f;
        outline: none;
    }

    #file-to-upload {
        outline: none;
    }

    .pdf-container::-webkit-scrollbar {
        width: .1rem;
    }

    .pdf-container::-webkit-scrollbar-track {
        background: rgb(3, 3, 3);
    }

    .pdf-container::-webkit-scrollbar-thumb {
        background-color: rgb(193, 56, 186);
        border-radius: 1.5vh;
    }

    .btn-close {
        background-color: rgb(193, 56, 186);
    }
</style>

<body >
    <div class="offcanvas offcanvas-end" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1"
        id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasScrollingLabel">
                AI Assistant
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="query-list-box text-start"></div>
            <div class="d-flex flex-column mb-3">
                <div class="p-2 query-box">
                    <input type="text" class="query-input-box" />
                    <button class="btn send-query">Enter</button>
                </div>
                <!-- <div class="p-2">Flex item 2</div> -->
                <!-- <div class="p-2">Flex item 3</div> -->
            </div>
        </div>
    </div>

    <div class="d-flex flex-row mb-3 justify-content-between main-container">
        <div class="p-2 pdf-container">
            <div class="p-2">
                <div class="into-heading">
                    <h1>It's not just reading anymore,
                        it's a conversation</h1>
                    <p style="margin-top: 2vh;">Say hello to documents that respond to you! With AskYourPDF, your
                        reading isn't just simple, it's fun!</p>
                    <button class="btn upload-docs" style="margin-top: 2vh;">Upload Documents</button>
                    <input type="file" name="pdfFile" id="file-to-upload" accept="application/pdf" />
                </div>
            </div>
        </div>
        <div class="p-2 chat-box-bot">
              <button class="btn pdf-analysis" type="button" data-bs-toggle="offcanvas"
                data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">
                Start Chatting
            </button>
        </div>
        <div class="p-2">
            <button class="btn upload-new-docs" type="button">
                Upload New Documents
            </button>
        </div>
        <!-- <div class="p-2">Flex item 3</div> -->
    </div>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"
        integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        const heading = document.querySelector(".pdf-container")
        const send_query = document.querySelector(".send-query")
        const chat_pdf = document.querySelector(".pdf-analysis")
        const upload_docs = document.querySelector(".upload-new-docs")
        const query_box = document.querySelector(".query-list-box")
        document.querySelector("#file-to-upload").style.display = "none";
        chat_pdf.style.display = "none";
        upload_docs.style.display = "none";

      function apend_query(text){
        let user_query_list = document.createElement("p")
        user_query_list.innerText = text
        query_box.append(user_query_list)
      }


        send_query.addEventListener("click", () => {
            let query = document.querySelector(".query-input-box")
            if (query.value) {
                console.log(query.value)
                apend_query(query.value)
                $.ajax({
                    url:"/query",
                    method:"GET",
                    data:{q:query.value},
                    dataType : "JSON",
                    success:function(data){
                        console.log(data)
                        apend_query(data["response"])
                    }
                })
            query.value = ""
        }
    })
        document.querySelector(".upload-docs").addEventListener("click", () => {
            document.querySelector("#file-to-upload").click()
            uploadFile()
            /*  heading.setAttribute("style","overflow:auto;height:90px;width:500px");*/
            heading.classList.add("text-center")
            heading.innerHTML = ``
            chat_pdf.style.display = "block"
            upload_docs.style.display = "block"

        })
        upload_docs.addEventListener("click", () => {
            if (confirm("You will lose the document changes you are working with")) {
                location.reload()
            }
        })

    </script>

</body>

</html>